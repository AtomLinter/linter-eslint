"use strict";var e=require("os"),t=require("child_process"),n=require("fs"),r=require("path"),o=require("atom"),i=require("assert"),a=require("crypto"),s=require("util");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=l(e),u=l(t),d=l(n),f=l(r),p=l(i),m=l(a),h=l(s);function g(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var v=g(c.default),y=g(d.default),w=g(f.default);const b=/\s+at.*(?:\(|\s)(.*)\)?/,E=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,_=void 0===v.default.homedir?"":v.default.homedir();class x extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t=(e=[...e].map((e=>e instanceof Error?e:null!==e&&"object"==typeof e?Object.assign(new Error(e.message),e):new Error(e)))).map((e=>{return"string"==typeof e.stack?(e=>e.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""))((t=e.stack,n=Object.assign({pretty:!1},n),t.replace(/\\/g,"/").split("\n").filter((e=>{const t=e.match(b);if(null===t||!t[1])return!0;const n=t[1];return!n.includes(".app/Contents/Resources/electron.asar")&&!n.includes(".app/Contents/Resources/default_app.asar")&&!E.test(n)})).filter((e=>""!==e.trim())).map((e=>n.pretty?e.replace(b,((e,t)=>e.replace(t,t.replace(_,"~")))):e)).join("\n"))):String(e);var t,n})).join("\n");t="\n"+((e,t=1,n)=>{if(n={indent:" ",includeEmptyLines:!1,...n},"string"!=typeof e)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if("number"!=typeof t)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if("string"!=typeof n.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n.indent}\``);if(0===t)return e;const r=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(r,n.indent.repeat(t))})(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors)yield e}}var S=x;const P=(e,t,n)=>new Promise(((r,o)=>{if(n=Object.assign({concurrency:1/0},n),"function"!=typeof t)throw new TypeError("Mapper function is required");const{concurrency:i}=n;if(!("number"==typeof i&&i>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${i}\` (${typeof i})`);const a=[],s=e[Symbol.iterator]();let l=!1,c=!1,u=0,d=0;const f=()=>{if(l)return;const e=s.next(),n=d;if(d++,e.done)return c=!0,void(0===u&&r(a));u++,Promise.resolve(e.value).then((e=>t(e,n))).then((e=>{a[n]=e,u--,f()}),(e=>{l=!0,o(e)}))};for(let e=0;e<i&&(f(),!c);e++);}));var k=P,j=P;k.default=j;const A=async(e,t,n)=>(await k(e,((e,n)=>Promise.all([t(e,n),e])),n)).filter((e=>Boolean(e[0]))).map((e=>e[1]));var O=A,T=A;O.default=T;const C="undefined"!=typeof atom,N="undefined"!=typeof atom&&(atom.inDevMode()||atom.inSpecMode());var $=/["'&<>]/,R=function(e){var t,n=""+e,r=$.exec(n);if(!r)return n;var o="",i=0,a=0;for(i=r.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}a!==i&&(o+=n.substring(a,i)),a=i+1,o+=t}return a!==i?o+n.substring(a,i):o};function I(e,t,n){let r;const o=async function(e,t,n){const r=u.default.spawn(e,t,n),o=new Promise(((e,t)=>{const o={stdout:r.stdout?[]:null,stderr:r.stderr?[]:null};r.on("error",t),r.stdout&&r.stdout.on("data",(function(e){o.stdout.push(e),n.handleStdout&&n.handleStdout(e)})),r.stderr&&r.stderr.on("data",(function(e){o.stderr.push(e),n.handleStderr&&n.handleStderr(e)})),r.on("close",(t=>{let r=null;null!=o.stdout&&(r=null===n.encoding||"buffer"===n.encoding?Buffer.concat(o.stdout):o.stdout.join(""));let i=null;null!=o.stderr&&(i=null===n.encoding||"buffer"===n.encoding?Buffer.concat(o.stderr):o.stderr.join("")),e({exitCode:t,stdout:r,stderr:i})}))}));return n.handleChildProcess(r),o}(e,t,{...n,handleChildProcess(e){r=e}});return o.kill=function(e){return r.kill(e)},o}async function L(e){if(C){const t=await async function(e){var t;const n=atom.packages.getLoadedPackage(e.name);return null==n?null:null!==(t=n.metadata.version)&&void 0!==t?t:null}(e);if(t)return t}return async function(e){var t,n;const{directory:r}=e;if(null==r)return null;let o=null;try{o=JSON.parse(await y.default.promises.readFile(w.default.join(r,"package.json"),"utf8"))}catch(e){return null}return null!==(t=null===(n=o)||void 0===n?void 0:n.version)&&void 0!==t?t:null}(e)}const M=C?async function(e){return atom.packages.resolvePackagePath(e)}:async function(e){var t;const n=w.default.join(null!==(t=process.env.ATOM_HOME)&&void 0!==t?t:w.default.join(v.default.homedir(),".atom"),"packages",e);try{return await y.default.promises.access(n,y.default.constants.R_OK),n}catch(e){return null}};function D(e,t){if(!e)throw new Error(null!=t?t:"Invariant violation")}async function F(e){const t=await(C?async function(e){const t=atom.packages.getLoadedPackage(e),n=t&&t.metadata["package-deps"];return Array.isArray(n)?n:[]}(e):async function(e){let t=null;try{t=await y.default.promises.stat(e)}catch(e){}if(null==t||!t.isDirectory())throw new Error("[Package-Deps] Expected packageName to be a readable directory in Node.js invocation");let n=null;try{const t=await y.default.promises.readFile(w.default.join(e,"package.json"),"utf8");n=JSON.parse(t)}catch(e){}const r=null==n||"object"!=typeof n?[]:n["package-deps"];return Array.isArray(r)?r:[]}(e));return N&&(D(Array.isArray(t),`Dependencies for ${e} are not a valid array`),t.forEach(((t,n)=>{if(Array.isArray(t))t.forEach(((t,r)=>{const o=`Dependency#${n}#${r} for ${e} is invalid`;D("string"==typeof t.name&&t.name.length>0,o),D(null==t.minimumVersion||"string"==typeof t.minimumVersion&&t.minimumVersion.length>0,o)})),D(t.length>0,`Dependency#${n} for ${e} has no group items`);else{const r=`Dependency#${n} for ${e} is invalid`;D("string"==typeof t.name&&t.name.length>0,r),D(null==t.minimumVersion||"string"==typeof t.minimumVersion&&t.minimumVersion.length>0,r)}}))),t}async function H(e){if(null==e.directory)return!0;if(null==e.minimumVersion)return!1;const t=await L(e);return null==t||1===function(e,t){for(var n=e.split("."),r=t.split("."),o=0;o<3;o++){var i=Number(n[o]),a=Number(r[o]);if(i>a)return 1;if(a>i)return-1;if(!isNaN(i)&&isNaN(a))return 1;if(isNaN(i)&&!isNaN(a))return-1}return 0}(e.minimumVersion,t)}const U=new Set(["âœ“","done"]),W=/(?:Installing|Moving) (.*?) to .* (.*)/;async function q(e){if("string"==typeof e)return{name:e,directory:await M(e)};if("name"in e)return{...e,directory:await M(e.name)};throw console.error("This package-deps entry is not valid. Please see https://github.com/steelbrain/package-deps#how-it-works",{entry:e}),Error("The package-deps entry is not valid. Please see https://github.com/steelbrain/package-deps#how-it-works")}let K=!0;const z=C?function({packageName:e,dependencies:t}){const n=[],r=atom.notifications.addInfo(`Installing ${e} dependencies`,{detail:`Installing ${t.map((e=>e.name)).join(", ")}`,dismissable:!0}),o=document.createElement("progress");o.max=t.length,o.style.width="100%";try{var i;const e=atom.views.getView(r),t=null!==(i=null==e?void 0:e.element)&&void 0!==i?i:null;if(null==t)throw new Error("Unable to get notification element from view");const n=t.querySelector(".detail-content");if(null==n)throw new Error("Content detail container not found inside the notification");n.appendChild(o)}catch(e){console.error("[Package-Deps] Error during showing installation progress to user",e)}return{handleFailure({dependency:e,error:t}){var r;n.push(e.name),o.value+=1,console.error(`[Package-Deps] Unable to install ${e.name}, Error:`,null!==(r=null==t?void 0:t.stack)&&void 0!==r?r:t)},handleDependencyInstalled(e){o.value+=1},handleComplete(){r.dismiss(),n.length>0?atom.notifications.addWarning(`Failed to install ${e} dependencies`,{detail:`These packages were not installed, check your console\nfor more info.\n${n.join("\n")}`,dismissable:!0}):atom.notifications.addSuccess(`Installed ${e} dependencies`,{detail:`Installed ${t.map((e=>e.name)).join(", ")}`}),Promise.all(t.map((e=>n.includes(e.name)?null:atom.packages.activatePackage(e.name)))).catch((t=>{console.error(`[Package-Deps] Error activating installed packages for ${e}`,t)}))}}}:function({dependencies:e}){let t=!1;return console.log(`Installing dependencies:\n${e.map((e=>`  - ${e.name}`)).join("\n")}`),{handleFailure({dependency:e,error:n}){var r;t=!0,console.error(`Unable to install ${e.name}, Error:`,null!==(r=null==n?void 0:n.stack)&&void 0!==r?r:n)},handleDependencyInstalled(e){console.log("Successfully installed",e.name)},handleComplete(){console.log("Installation complete"),t&&(process.exitCode=1)}}},V=C?function({packageName:e,dependencies:t}){return new Promise((n=>{const r=t.filter((e=>!Array.isArray(e))),o=t.filter((e=>Array.isArray(e))),i=0===o.length,a=i?r.map((e=>e.name)).join(", "):"Something went wrong. Check your developer console",s=o.map((e=>e[0]));atom.packages.isPackageDisabled("notifications")&&console.warn(`Enable notifications to install dependencies for ${e}`);const l=atom.notifications.addInfo(`${e} needs to install dependencies`,{dismissable:!0,icon:"cloud-download",detail:a,description:`Install dependenc${1===t.length?"y":"ies"}?`,buttons:[{text:"Yes",onDidClick:()=>{n(i?r:r.concat(s)),l.dismiss()}},{text:"No Thanks",onDidClick:()=>{l.dismiss()}},{text:"Never",onDidClick:()=>{!function(e){var t;if(!C)return;const n=new Set(null!==(t=atom.config.get("atom-package-deps.ignored"))&&void 0!==t?t:[]);n.add(e),atom.config.set("atom-package-deps.ignored",Array.from(n))}(e),K&&(K=!1,atom.notifications.addInfo("How to reset package-deps memory",{dismissable:!0,description:"To modify the list of ignored files invoke 'Application: Open Your Config' and change the 'atom-package-deps' section"})),l.dismiss()}}]});if(l.onDidDismiss((()=>n([]))),!i)try{var c;const e=atom.views.getView(l),t=null!==(c=null==e?void 0:e.element)&&void 0!==c?c:null;if(null==t)throw new Error("Unable to get notification element from view");const n=t.querySelector(".detail-content");if(null==n)throw new Error("Content detail container not found inside the notification");if(n.innerHTML="",r.length>0){const e=document.createElement("div");e.innerHTML=`Packages without choices: <br /><ul><li>${r.map((e=>R(e.name))).join("</li><li>")}</li></ul>`,n.appendChild(e)}const i=document.createElement("div");i.innerHTML="Packages with choices:",n.appendChild(i);const a=document.createElement("ul");o.forEach(((e,t)=>{const n=document.createElement("li"),r=document.createElement("select");r.innerHTML=e.map((e=>`<option>${R(e.name)}</option>`)).join("\n"),r.addEventListener("change",(()=>{const n=e.find((e=>e.name===r.value));null!=n&&(s[t]=n)})),n.style.marginTop="5px",n.appendChild(r),a.appendChild(n)})),n.appendChild(a)}catch(e){console.error("[Package-Deps] Error during showing package choices to user",e)}}))}:async function({dependencies:e}){return e.map((e=>Array.isArray(e)?e[0]:e))};var B=async function(e,t=!1){if(D("string"==typeof e&&e.length>0,"[Package-Deps] Package name is required"),n=e,C&&(null!==(r=atom.config.get("atom-package-deps.ignored"))&&void 0!==r?r:[]).includes(n))return;var n,r;const o=await F(e);if(0===o.length)return;const i=await Promise.all(o.map((async e=>Array.isArray(e)?Promise.all(e.map(q)):q(e)))),a=await O(i,(async function(e){return Array.isArray(e)?(await Promise.all(e.map((e=>H(e))))).every(Boolean):H(e)}));if(0===a.length)return;let s;if(s=t?a.map((e=>Array.isArray(e)?e[0]:e)):await V({packageName:e,dependencies:a}),0===s.length)return;const l=z({packageName:e,dependencies:s});await(async(e,t,{concurrency:n=1/0,stopOnError:r=!0}={})=>new Promise(((o,i)=>{if("function"!=typeof t)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(n)&&n!==1/0||!(n>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${n}\` (${typeof n})`);const a=[],s=[],l=e[Symbol.iterator]();let c=!1,u=!1,d=0,f=0;const p=()=>{if(c)return;const e=l.next(),n=f;if(f++,e.done)return u=!0,void(0===d&&(r||0===s.length?o(a):i(new S(s))));d++,(async()=>{try{const r=await e.value;a[n]=await t(r,n),d--,p()}catch(e){r?(c=!0,i(e)):(s.push(e),d--,p())}})()};for(let e=0;e<n&&(p(),!u);e++);})))(s,(async function(e){try{await async function(e){const t=C?`"${atom.packages.getApmPath()}"`:"apm",{stdout:n,stderr:r}=await I(t,["install",e.name,"--production","--color","false"],{shell:!0}),o=W.exec(n.trim());if(null!=o&&U.has(o[2]))return;const i=new Error(`Error installing dependency: ${e.name}`);throw i.stack=r.trim(),i}(e),l.handleDependencyInstalled(e)}catch(t){l.handleFailure({dependency:e,error:t})}}),{concurrency:2}),l.handleComplete()},J=Object.defineProperty({install:B},"__esModule",{value:!0});const Y=(e,t,n)=>((e,t)=>{if(!t)throw new Error(e);return!0})(`${t}:${n} isn't a valid point!`,((e,t,n)=>e.clipPosition([t,n]).isEqual([t,n]))(e,t,n)),X=(e,t)=>e.getCursors().some((e=>e.getScopeDescriptor().getScopesArray().some((e=>t.includes(e)))));var G="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Z(e){var t={exports:{}};return e(t,t.exports),t.exports}function Q(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}var ee="[object GeneratorFunction]",te=/^\[object .+?Constructor\]$/,ne="object"==typeof G&&G&&G.Object===Object&&G,re="object"==typeof self&&self&&self.Object===Object&&self,oe=ne||re||Function("return this")();function ie(e,t){return!!(e?e.length:0)&&function(e,t,n){if(t!=t)return function(e,t,n,r){var o=e.length,i=n+(r?1:-1);for(;r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}(e,se,n);var r=n-1,o=e.length;for(;++r<o;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function ae(e,t,n){for(var r=-1,o=e?e.length:0;++r<o;)if(n(t,e[r]))return!0;return!1}function se(e){return e!=e}function le(e,t){return e.has(t)}function ce(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var ue,de=Array.prototype,fe=Function.prototype,pe=Object.prototype,me=oe["__core-js_shared__"],he=(ue=/[^.]+$/.exec(me&&me.keys&&me.keys.IE_PROTO||""))?"Symbol(src)_1."+ue:"",ge=fe.toString,ve=pe.hasOwnProperty,ye=pe.toString,we=RegExp("^"+ge.call(ve).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),be=de.splice,Ee=Ne(oe,"Map"),_e=Ne(oe,"Set"),xe=Ne(Object,"create");function Se(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ke(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function je(e){var t=-1,n=e?e.length:0;for(this.__data__=new ke;++t<n;)this.add(e[t])}function Ae(e,t){for(var n,r,o=e.length;o--;)if((n=e[o][0])===(r=t)||n!=n&&r!=r)return o;return-1}function Oe(e){return!(!$e(e)||(t=e,he&&he in t))&&(function(e){var t=$e(e)?ye.call(e):"";return"[object Function]"==t||t==ee}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?we:te).test(function(e){if(null!=e){try{return ge.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}Se.prototype.clear=function(){this.__data__=xe?xe(null):{}},Se.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Se.prototype.get=function(e){var t=this.__data__;if(xe){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return ve.call(t,e)?t[e]:void 0},Se.prototype.has=function(e){var t=this.__data__;return xe?void 0!==t[e]:ve.call(t,e)},Se.prototype.set=function(e,t){return this.__data__[e]=xe&&void 0===t?"__lodash_hash_undefined__":t,this},Pe.prototype.clear=function(){this.__data__=[]},Pe.prototype.delete=function(e){var t=this.__data__,n=Ae(t,e);return!(n<0)&&(n==t.length-1?t.pop():be.call(t,n,1),!0)},Pe.prototype.get=function(e){var t=this.__data__,n=Ae(t,e);return n<0?void 0:t[n][1]},Pe.prototype.has=function(e){return Ae(this.__data__,e)>-1},Pe.prototype.set=function(e,t){var n=this.__data__,r=Ae(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},ke.prototype.clear=function(){this.__data__={hash:new Se,map:new(Ee||Pe),string:new Se}},ke.prototype.delete=function(e){return Ce(this,e).delete(e)},ke.prototype.get=function(e){return Ce(this,e).get(e)},ke.prototype.has=function(e){return Ce(this,e).has(e)},ke.prototype.set=function(e,t){return Ce(this,e).set(e,t),this},je.prototype.add=je.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},je.prototype.has=function(e){return this.__data__.has(e)};var Te=_e&&1/ce(new _e([,-0]))[1]==1/0?function(e){return new _e(e)}:function(){};function Ce(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function Ne(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Oe(n)?n:void 0}function $e(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var Re,Ie=function(e){return e&&e.length?function(e,t,n){var r=-1,o=ie,i=e.length,a=!0,s=[],l=s;if(n)a=!1,o=ae;else if(i>=200){var c=t?null:Te(e);if(c)return ce(c);a=!1,o=le,l=new je}else l=t?[]:s;e:for(;++r<i;){var u=e[r],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),s.push(u)}else o(l,d,n)||(l!==s&&l.push(d),s.push(u))}return s}(e):[]},Le=Z((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.assign=t.CACHE_KEY=t.KNOWN_SHELLS=void 0,t.identifyEnvironment=function(){var e=a(),t=e.command,n=e.parameters,r=e.options;return r.timeout=4e3,(0,u.default.spawnSync)(t,n,r).stdout.toString().split("\0")},t.identifyEnvironmentAsync=function(){return new Promise((function(e,t){var n=a(),r=n.command,o=n.parameters,i=n.options,s=(0,u.default.spawn)(r,o,i),l=[],c=setTimeout((function(){s.kill(),t(new Error("Process execution timed out"))}),4e3);s.stdout.on("data",(function(e){l.push(e)})),s.on("close",(function(){clearTimeout(c),e(l.join("").split("\0"))})),s.on("error",(function(e){t(e)}))}))},t.parse=function(e){var t={},n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=s.indexOf("=");if(-1!==l){var c=s.slice(0,l),u=s.slice(l+1);t[c]=u}}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t},t.applySugar=function(e){var t=process.env.PATH?process.env.PATH.split(":"):[];if(e.PATH){var o=!0,a=!1,s=void 0;try{for(var l,c=e.PATH.split(":")[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;u&&-1===t.indexOf(u)&&t.push(u)}}catch(e){a=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(a)throw s}}}var d=!0,f=!1,p=void 0;try{for(var m,h=i[Symbol.iterator]();!(d=(m=h.next()).done);d=!0){var g=m.value;-1===t.indexOf(g)&&(t=[g].concat(t))}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}e.USER||(process.env.USER?e.USER=process.env.USER:e.HOME&&(e.USER=n.default.basename(e.HOME)));return e.PATH=(0,r.default)(t).join(":"),e.PWD=process.cwd(),e.OLDPWD=e.PWD,e},t.getCommand=a;var n=o(f.default),r=o(Ie);function o(e){return e&&e.__esModule?e:{default:e}}var i=["/bin","/sbin","/usr/bin","/usr/sbin","/usr/local/bin","/usr/local/sbin"];function a(){var e='import os;print(\\"\\0\\".join(map(\\"=\\".join, dict(os.environ).items()))+\\"\\0\\")',t='python -c "'+e+'"||python3 -c "'+e+'"||env|sed -n -e "s/^\\([A-Za-z_][A-Za-z0-9_]*\\)=.*/\\1/p"|while read name;do [ "$name" != "_" -a -n "$(eval "printf \\"%s\\" \\"\\${$name+x}\\"")" ]&&value="$(eval "printf \\"%s\\" \\"\\${$name}\\"")"&&printf "%s=%s\\0" "$name" "$value";done;exit;',r="sh -c '"+t+"';exit;",o=process.env.SHELL||"sh",i=["-c",r],a=n.default.basename(o);return"bash"===a?i=["-c","source ~/.bashrc;source ~/.bash_profile;"+t]:"zsh"===a?i=["-c","source ~/.zshrc;"+t]:"fish"===a?i=["-c","source ~/.config/fish/config.fish;"+r]:"sh"!==a&&"ksh"!==a||(i=["-c",t]),{command:o,parameters:i,options:{encoding:"utf8"}}}t.KNOWN_SHELLS=["zsh","bash","fish"],t.CACHE_KEY="__STEELBRAIN_CONSISTENT_ENV_V1",t.assign=Object.assign||function(e,t){for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}})),Me=(Re=f.default)&&Re.__esModule?Re:{default:Re};var De=function(){if("win32"===process.platform||!process.env.SHELL)return(0,Le.assign)({},process.env);if(G[Le.CACHE_KEY])return(0,Le.assign)({},G[Le.CACHE_KEY]);var e=Me.default.basename(process.env.SHELL);if(-1===Le.KNOWN_SHELLS.indexOf(e))return(0,Le.assign)({},process.env);try{var t=(0,Le.applySugar)((0,Le.parse)((0,Le.identifyEnvironment)()));return G[Le.CACHE_KEY]=t,t}catch(e){return console.error("[consistent-env] Unable to determine environment",e),(0,Le.assign)({},process.env)}};De.async=function(){return new Promise((function(e){if("win32"!==process.platform&&process.env.SHELL)if(G[Le.CACHE_KEY])e((0,Le.assign)({},G[Le.CACHE_KEY]));else{var t=Me.default.basename(process.env.SHELL);-1===Le.KNOWN_SHELLS.indexOf(t)?e((0,Le.assign)({},process.env)):e((0,Le.identifyEnvironmentAsync)().then(Le.parse).then(Le.applySugar).then((function(e){return G[Le.CACHE_KEY]=e,e})))}else e((0,Le.assign)({},process.env))})).catch((function(e){return console.error("[consistent-env] Unable to determine environment",e),(0,Le.assign)({},process.env)}))};var Fe=Symbol("cache deleted");var He=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];function n(){for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=JSON.stringify(o),s=o.length;if(a in n.__sb_cache&&n.__sb_cache[a]!==Fe){var l=n.__sb_cache[a];return!t.async||l&&"Promise"===l.constructor.name?l:Promise.resolve(l)}var c=void 0;if(c=1===s?e.call(this,o[0]):2===s?e.call(this,o[0],o[1]):3===s?e.call(this,o[0],o[1],o[2]):4===s?e.call(this,o[0],o[1],o[2],o[3]):e.apply(this,o),n.__sb_cache[a]=c,t.async){if(!c||"Promise"!==c.constructor.name)throw new Error("Memoization Error, Async function returned non-promise value");return c.then((function(e){return n.__sb_cache[a]=e,e}),(function(e){throw n.__sb_cache[a]=Fe,e}))}return c}return n.__sb_cache={},n};function Ue(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];return function(){for(var n=this,r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=new Promise((function(t,r){o.push((function(e,n){e?r(e):t(n)})),e.apply(n,o)}));return t||(a=a.then((function(e){return void 0===e||e})).catch((function(){return!1}))),a}}var We,qe,Ke=Ue,ze=Ue,Ve=function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=Object.assign({},e);for(var r in n)({}).hasOwnProperty.call(n,r)&&"function"==typeof n[r]&&(n[r+"Async"]=Ue(n[r],t));return n},Be=Object.defineProperty({default:Ke,promisify:ze,promisifyAll:Ve},"__esModule",{value:!0}),Je=Z((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.findAsync=t.find=void 0;var n,r,o=(n=function*(e,t){for(var n=[].concat(t),r=e.split(i.default.sep);r.length;){var o=r.join(i.default.sep);""===o&&(o=i.default.resolve(e,"/"));for(var s=0,l=n.length;s<l;++s){var u=n[s],d=i.default.join(o,u);try{return yield c(d,a.default.R_OK),d}catch(e){}}r.pop()}return null},r=function(){var e=n.apply(this,arguments);return new Promise((function(t,n){function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then((function(e){return r("next",e)}),(function(e){return r("throw",e)}));t(s)}return r("next")}))},function(e,t){return r.apply(this,arguments)}),i=l(f.default),a=l(d.default),s=l(He);function l(e){return e&&e.__esModule?e:{default:e}}var c=(0,l(Be).default)(a.default.access);t.find=(0,s.default)((function(e,t){for(var n=[].concat(t),r=e.split(i.default.sep);r.length;){var o=r.join(i.default.sep);""===o&&(o=i.default.resolve(e,"/"));for(var s=0,l=n.length;s<l;++s){var c=n[s],u=i.default.join(o,c);try{return a.default.accessSync(u,a.default.R_OK),u}catch(e){}}r.pop()}return null})),t.findAsync=(0,s.default)(o,{async:!0})})),Ye=Z((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clearCache=t.getPathAsync=t.getPath=void 0;var n,r,o=(n=function*(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=e;return t||(t=process.cwd()),(yield(0,Je.findAsync)(t,i.default.join("node_modules",".bin")))||""},r=function(){var e=n.apply(this,arguments);return new Promise((function(t,n){function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then((function(e){return r("next",e)}),(function(e){return r("throw",e)}));t(s)}return r("next")}))},function(e){return r.apply(this,arguments)}),i=function(e){return e&&e.__esModule?e:{default:e}}(f.default);function a(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=e;return t||(t=process.cwd()),(0,Je.find)(t,i.default.join("node_modules",".bin"))||""}t.default=a,t.getPath=a,t.getPathAsync=o,t.clearCache=function(){Je.find.__sb_cache={},Je.findAsync.__sb_cache={}}})),Xe=Z((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getSpawnOptions=void 0;var n,r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getSpawnOptions=(n=function*(e){var t=Object.assign({},e,{env:d(yield(0,De.async)(),e.env)}),n=void 0,r=e.local;if(r&&(n=yield(0,Ye.getPathAsync)(r.directory)),r&&n)for(var o in t.env)if({}.hasOwnProperty.call(t.env,o)&&"PATH"===o){var i=t.env[o];t.env[o]=r.prepend?n+c+i:i+c+n;break}return delete t.timeout,t.env.OS&&(t.env.OS=void 0),process.versions.electron&&(t.env.ELECTRON_RUN_AS_NODE="1",t.env.ATOM_SHELL_INTERNAL_RUN_AS_NODE="1",t.env.ELECTRON_NO_ATTACH_CONSOLE="1"),t},r=function(){var e=n.apply(this,arguments);return new Promise((function(t,n){function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then((function(e){r("next",e)}),(function(e){r("throw",e)}));t(s)}return r("next")}))},function(e){return r.apply(this,arguments)}),t.validate=function(e,t,n){var r=Object.assign({},n);if((0,a.default)("string"==typeof e&&e,"filePath must be a string"),(0,a.default)(Array.isArray(t),"parameters must be an array"),(0,a.default)("object"===(void 0===r?"undefined":o(r))&&r,"options must be an object"),r.stream){var i=r.stream;(0,a.default)("both"===i||"stdout"===i||"stderr"===i,"options.stream should be stdout|stderr|both")}else r.stream="stdout";r.timeout?(0,a.default)("number"==typeof r.timeout,"options.timeout must be a number"):r.timeout=1/0;r.env?(0,a.default)("object"===o(r.env),"options.env must be an object"):r.env={};r.stdin?(0,a.default)("string"==typeof r.stdin||Buffer.isBuffer(r.stdin),"options.stdin must be a string or a Buffer"):r.stdin=null;void 0!==r.throwOnStderr?(0,a.default)("boolean"==typeof r.throwOnStderr,"options.throwOnStderr must be a boolean"):r.throwOnStderr=!0;void 0!==r.local&&((0,a.default)("object"===o(r.local),"options.local must be an object"),(0,a.default)("string"==typeof r.local.directory,"options.local.directory must be a string"),void 0!==r.local.prepend?(0,a.default)("boolean"==typeof r.local.prepend,"options.local.prepend must be a boolean"):r.local.prepend=!1);void 0!==r.allowEmptyStderr?(0,a.default)("boolean"==typeof r.allowEmptyStderr,"options.throwWhenEmptyStderr must be a boolean"):r.allowEmptyStderr=!1;void 0!==r.ignoreExitCode?(0,a.default)("boolean"==typeof r.ignoreExitCode,"options.ignoreExitCode must be a boolean"):r.ignoreExitCode=!1;return r},t.mergePath=u,t.mergeEnv=d,t.escape=function(e){return'"'+String(e).replace(/"/g,'\\"')+'"'},t.shouldNormalizeForWindows=function(e,t){var n=i.default.basename(e);return"win32"===process.platform&&!t.shell&&"cmd.exe"!==n&&"cmd"!==n},t.getENOENTError=function(e,t){var n=new Error("spawn "+e+" ENOENT");return n.code="ENOENT",n.errno="ENOENT",n.syscall="spawn "+e,n.path=e,n.spawnargs=t,n};var i=l(f.default),a=l(p.default),s=l(Ie);function l(e){return e&&e.__esModule?e:{default:e}}var c="win32"===process.platform?";":":";function u(e,t){return(0,s.default)(e.split(";").concat(t.split(";")).map((function(e){return e.trim()})).filter((function(e){return e}))).join(";")}function d(e,t){if("win32"!==process.platform)return Object.assign(e,t);var n={PATH:""};for(var r in e)"PATH"===r.toUpperCase()?n.PATH=u(n.PATH,e[r]):n[r]=e[r];for(var o in t)"PATH"===o.toUpperCase()?n.PATH=u(n.PATH,t[o]):n[o]=t[o];return n}})),Ge=(We=et((function*(e,t,n,r){var o=yield(0,Xe.getSpawnOptions)(n),i=e,a=t,s=!1;if((0,Xe.shouldNormalizeForWindows)(i,n)){o.windowsVerbatimArguments=!0;var l=[i];/\s/.test(i)&&(l=l.map(Xe.escape)),l=l.concat(a.map(Xe.escape)),i=process.env.comspec||"cmd.exe",a=["/s","/c",'"'+l.join(" ")+'"'],s=!0}return new Promise((function(l,c){var d=(0,u.default.spawn)(i,a,o),f={stdout:[],stderr:[]},p=void 0;if(d.stdout&&d.stdout.on("data",(function(e){f.stdout.push(e)})),d.stderr&&d.stderr.on("data",(function(e){f.stderr.push(e)})),d.on("error",(function(e){c(e)})),d.on("close",(function(r){clearTimeout(p);var o=f.stdout.join("").trim(),i=f.stderr.join("").trim();s&&i==="'"+e+"' is not recognized as an internal or external command,\r\noperable program or batch file."?c((0,Xe.getENOENTError)(e,t)):"stdout"===n.stream?i&&n.throwOnStderr?c(new Error(i)):0===r||n.ignoreExitCode?l(o):(console.error("[exec] Process exited with no-zero code, stdout: ",o),c(new Error("Process exited with non-zero code: "+r))):"stderr"===n.stream?0!==i.length||n.allowEmptyStderr?l(i):c(new Error("Process exited with no output, code: "+r)):l({stdout:o,stderr:i,exitCode:r})})),d.stdin){if(n.stdin)try{d.stdin.write(n.stdin)}catch(e){}try{d.stdin.end()}catch(e){}}n.timeout!==1/0&&(p=setTimeout((function(){Ze(d),c(new Error("Process execution timed out"))}),n.timeout)),r(d)}))})),function(e,t,n,r){return We.apply(this,arguments)}),Ze=(qe=et((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SIGTERM",n=Qe.default.basename(e.spawnfile);if("win32"===process.platform&&"wmic.exe"!==n&&"wmic"!==n)try{var r=yield tt("wmic",["process","where","(ParentProcessId="+e.pid+")","get","processid"],{stream:"stdout",timeout:6e4});r.split(/\s+/).filter((function(e){return/^\d+$/.test(e)})).map((function(e){return parseInt(e,10)})).filter((function(t){return t!==e.pid&&t>0})).forEach((function(e){process.kill(e,t)}))}catch(e){}else e.kill(t)})),function(e){return qe.apply(this,arguments)}),Qe=function(e){return e&&e.__esModule?e:{default:e}}(f.default);function et(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(s)}("next")}))}}function tt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,Xe.validate)(e,t,n),o=null,i=null,a=Ge(e,t,r,(function(e){o?Ze(e,o):i=e}));return a.kill=function(e){i?Ze(i,e):o=e||"SIGTERM"},a}var nt={exec:tt,execNode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,Xe.validate)(e,t,n),tt(process.execPath,[e].concat(t),n)}},rt="win32"===process.platform,ot=rt?/[^:]\\$/:/.\/$/;const it=process.binding("constants"),at=(pt=rt?process.env.TEMP||process.env.TMP||(process.env.SystemRoot||process.env.windir)+"\\temp":process.env.TMPDIR||process.env.TMP||process.env.TEMP||"/tmp",ot.test(pt)&&(pt=pt.slice(0,-1)),pt),st="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",lt=/XXXXXX/,ct=(it.O_CREAT||it.fs.O_CREAT)|(it.O_EXCL||it.fs.O_EXCL)|(it.O_RDWR||it.fs.O_RDWR),ut=it.EBADF||it.os.errno.EBADF,dt=it.ENOENT||it.os.errno.ENOENT,ft=[];var pt,mt=!1,ht=!1;function gt(e){var t=[],n=null;try{n=m.default.randomBytes(e)}catch(t){n=m.default.pseudoRandomBytes(e)}for(var r=0;r<e;r++)t.push(st[n[r]%st.length]);return t.join("")}function vt(e){return void 0===e}function yt(e,t){return"function"==typeof e?[t||{},e]:vt(e)?[{},t]:[e,t]}function wt(e){if(e.name)return f.default.join(e.dir||at,e.name);if(e.template)return e.template.replace(lt,gt(6));const t=[e.prefix||"tmp-",process.pid,gt(12),e.postfix||""].join("");return f.default.join(e.dir||at,t)}function bt(e,t){var n=yt(e,t),r=n[0],o=n[1],i=r.name?1:r.tries||3;return isNaN(i)||i<0?o(new Error("Invalid tries")):r.template&&!r.template.match(lt)?o(new Error("Invalid template provided")):void function e(){const t=wt(r);d.default.stat(t,(function(n){if(!n)return i-- >0?e():o(new Error("Could not get a unique tmp filename, max tries reached "+t));o(null,t)}))}()}function Et(e){var t=yt(e)[0],n=t.name?1:t.tries||3;if(isNaN(n)||n<0)throw new Error("Invalid tries");if(t.template&&!t.template.match(lt))throw new Error("Invalid template provided");do{const e=wt(t);try{d.default.statSync(e)}catch(t){return e}}while(n-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function _t(e){const t=[e];do{for(var n=t.pop(),r=!1,o=d.default.readdirSync(n),i=0,a=o.length;i<a;i++){var s=f.default.join(n,o[i]);d.default.lstatSync(s).isDirectory()?(r||(r=!0,t.push(n)),t.push(s)):d.default.unlinkSync(s)}r||d.default.rmdirSync(n)}while(0!==t.length)}function xt(e,t,n){const r=Pt((function(e){try{0<=e[0]&&d.default.closeSync(e[0])}catch(e){if(!(t=e,At(t,-ut,"EBADF")||jt(e)))throw e}var t;try{d.default.unlinkSync(e[1])}catch(e){if(!jt(e))throw e}}),[t,e]);return n.keep||ft.unshift(r),r}function St(e,t){const n=Pt(t.unsafeCleanup?_t:d.default.rmdirSync.bind(d.default),e);return t.keep||ft.unshift(n),n}function Pt(e,t){var n=!1;return function r(o){if(!n){const o=ft.indexOf(r);o>=0&&ft.splice(o,1),n=!0,e(t)}o&&o(null)}}function kt(){if(!ht||mt)for(;ft.length;)try{ft[0].call(null)}catch(e){}}function jt(e){return At(e,-dt,"ENOENT")}function At(e,t,n){return e.code==t||e.code==n}const Ot=process.versions.node.split(".").map((function(e){return parseInt(e,10)}));0===Ot[0]&&(Ot[1]<9||9===Ot[1]&&Ot[2]<5)&&process.addListener("uncaughtException",(function(e){throw ht=!0,kt(),e})),process.addListener("exit",(function(e){e&&(ht=!0),kt()}));var Tt={tmpdir:at,dir:function(e,t){var n=yt(e,t),r=n[0],o=n[1];bt(r,(function(e,t){if(e)return o(e);d.default.mkdir(t,r.mode||448,(function(e){if(e)return o(e);o(null,t,St(t,r))}))}))},dirSync:function(e){var t=yt(e)[0];const n=Et(t);return d.default.mkdirSync(n,t.mode||448),{name:n,removeCallback:St(n,t)}},file:function(e,t){var n=yt(e,t),r=n[0],o=n[1];r.postfix=vt(r.postfix)?".tmp":r.postfix,bt(r,(function(e,t){if(e)return o(e);d.default.open(t,ct,r.mode||384,(function(e,n){return e?o(e):r.discardDescriptor?d.default.close(n,(function(e){if(e){try{d.default.unlinkSync(t)}catch(t){jt(t)||(e=t)}return o(e)}o(null,t,void 0,xt(t,-1,r))})):r.detachDescriptor?o(null,t,n,xt(t,-1,r)):void o(null,t,n,xt(t,n,r))}))}))},fileSync:function(e){var t=yt(e)[0];t.postfix=t.postfix||".tmp";const n=t.discardDescriptor||t.detachDescriptor,r=Et(t);var o=d.default.openSync(r,ct,t.mode||384);return t.discardDescriptor&&(d.default.closeSync(o),o=void 0),{name:r,fd:o,removeCallback:xt(r,n?-1:o,t)}},tmpName:bt,tmpNameSync:Et,setGracefulCleanup:function(){mt=!0}},Ct=Z((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkFile=t.writeFile=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getWordRegexp=function(e,t){var n=e.scopeDescriptorForBufferPosition(t),r=(o=atom.config.get("editor.nonWordCharacters",{scope:n}),o.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"));var o;return new RegExp("^[\t ]*$|[^\\s"+r+"]+")},t.getTempDirectory=function(e){return new Promise((function(t,n){o.default.dir({prefix:e},(function(e,r,o){e?n(e):t({path:r,cleanup:o})}))}))},t.fileExists=function(e){return new Promise((function(t){r.default.access(e,r.default.R_OK,(function(e){t(null===e)}))}))},t.validateExec=function(e,t,r){if("string"!=typeof e)throw new Error("Invalid or no `command` provided");if(!(t instanceof Array))throw new Error("Invalid or no `args` provided");if("object"!==(void 0===r?"undefined":n(r)))throw new Error("Invalid or no `options` provided")},t.validateEditor=function(e){var t=void 0;t="function"==typeof atom.workspace.isTextEditor?atom.workspace.isTextEditor(e):"function"==typeof e.getText;if(!t)throw new Error("Invalid TextEditor provided")},t.validateFind=function(e,t){if("string"!=typeof e)throw new Error("Invalid or no `directory` provided");if("string"!=typeof t&&!(t instanceof Array))throw new Error("Invalid or no `name` provided")},t.wrapExec=function(e){return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!1,i=e(t,n,Object.assign({timeout:1e4},r)),a=i;if(r.uniqueKey){if("string"!=typeof r.uniqueKey)throw new Error("options.uniqueKey must be a string");var l=s.get(r.uniqueKey);l&&l(),s.set(r.uniqueKey,(function(){o=!0,i.kill()})),a=a.then((function(e){return o?null:e}),(function(e){if(o)return null;throw e}))}return a.catch((function(e){if("ENOENT"===e.code){var t=new Error("Failed to spawn command `"+e.path+"`. Make sure `"+e.path+"` is installed and on your PATH");throw t.code="ENOENT",t}throw e}))}};var r=a(d.default),o=a(Tt),i=a(Be);function a(e){return e&&e.__esModule?e:{default:e}}t.writeFile=(0,i.default)(r.default.writeFile),t.unlinkFile=(0,i.default)(r.default.unlink);var s=new Map})),Nt=Z((function(e,t){!function(t){var n,r=/^[$_a-z][$_a-z0-9]*$/i;function o(e){var t,n,o,i,a,s,l,c={},u=0,d="",f=!1;for(t=0;t<e.length;++t)if(n=e[t],i=(o=e[t+1])+e[t+2],d+=n,"\\"===n)if(f||"k<"!==i)d+=o,++t;else{if((a=e.indexOf(">",t+3))<0)throw new Error("'>' missing in named backreference.");if(!(l=c[s=e.substring(t+3,a)]))throw new Error("Named group '"+s+"' is not defined in backreference.");if("number"!=typeof l)throw new Error("Named backreference referencing duplicate named group '"+s+"'.");t=a,d+=l}else if(f)"]"===n&&(f=!1);else if("["===n)f=!0;else if("("===n&&"?:"!==i&&"?="!==i&&"?!"!==i&&(u++,"?<"===i||":<"===i)){if((a=e.indexOf(">",t+3))<0)throw new Error("'>' missing in named group.");if(s=e.substring(t+3,a),!r.test(s))throw new Error("Invalide group name '"+s+"'. Regexp group name should start with '_$a-zA-Z' and can contain only '_$a-zA-Z0-9'.");void 0===(l=c[s])?c[s]=u:"number"==typeof l?c[s]=[l,u]:l.push(u),t=a}return{mapper:c,regexText:d}}e.exports=function(e,t){if("boolean"!=typeof e){"string"!=typeof e&&(t=(e.global?"g":"")+(e.multiline?"m":"")+(e.ignoreCase?"i":""),e=e.source);var r=n?n[e]||(n[e]=o(e)):o(e),i=new RegExp(r.regexText,t);return i.groupsIndices=r.mapper,i.exec=function(e){var t=RegExp.prototype.exec.call(this,e);return t&&a(t),t},i.execGroups=function(e,t){var n=this.exec(e);return n?n.groups(t):null},i.replace=function(e,t){if("function"==typeof t)return e.replace(i,(function(){var e=Array.prototype.slice.call(arguments,0,arguments.length-2);return a(e),t.apply(e,arguments)}));var n=function(e,t){var n,r,o,i,a,s,l="";for(n=0;n<e.length;++n)if(r=e[n],o=e[n+1],l+=r,"$"===r)if("$"===o)l+=o,++n;else if("{"===o){if((a=e.indexOf("}",n+2))<0)throw new Error("'>' missing in replacement named group.");if(void 0===(s=t[i=e.substring(n+2,a)]))throw new Error("Named group '"+i+"' is not defined in replacement text.");if("number"!=typeof s)throw new Error("Named replacement referencing duplicate named group '"+i+"'.");l+=s,n=a}return l}(t,this.groupsIndices);return e.replace(this,n)},i}function a(e){var t,n,o=r.mapper;return e.group=function(t,n){var r=o[t];if("number"==typeof r)return e[r];if(n)return r.map((function(t){return e[t]}));if(r)for(var i=0;i<r.length;++i){var a=e[r[i]];if(void 0!==a)return a}},e.groups=function(r){var i=r?n:t;if(i)return i;for(var a in i={},o)i[a]=e.group(a,r);return r?n=i:t=i},e}!1===e?n=void 0:n||(n={})}}()})),$t=Z((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.execNode=t.exec=t.tempFiles=t.findCachedAsync=t.findAsync=t.FindCache=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=t.findAsync=function(){var e=u((function*(e,t){l.validateFind(e,t);for(var n=[].concat(t),r=e.split(a.sep);r.length;){var o=r.join(a.sep);""===o&&(o=a.resolve(e,"/"));var i=!0,s=!1,c=void 0;try{for(var u,d=n[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var f=u.value,p=a.join(o,f);if(yield l.fileExists(p))return p}}catch(e){s=!0,c=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw c}}r.pop()}return null}));return function(t,n){return e.apply(this,arguments)}}();t.findCachedAsync=function(){var e=u((function*(e,t){l.validateFind(e,t);var n=[].concat(t),o=e+":"+n.join(","),i=m.get(o);if(i){if(yield l.fileExists(i))return i;m.delete(o)}var a=yield r(e,n);return a&&m.set(o,a),a}));return function(t,n){return e.apply(this,arguments)}}();var o,i=t.tempFiles=(o=u((function*(e,t){if(!Array.isArray(e))throw new Error("Invalid or no `files` provided");if("function"!=typeof t)throw new Error("Invalid or no `callback` provided");var n=yield l.getTempDirectory("atom-linter_"),r=[];yield Promise.all(e.map((function(e){var t=e.name,o=e.contents,i=a.join(n.path,t);return r.push(i),l.writeFile(i,o)})));try{return yield t(r)}finally{yield Promise.all(r.map((function(e){return l.unlinkFile(e)}))),n.cleanup()}})),function(e,t){return o.apply(this,arguments)});t.generateRange=function(e,t,n){l.validateEditor(e);var r=t;("number"!=typeof r||!Number.isFinite(r)||r<0)&&(r=0);var o=e.getBuffer(),i=o.getLineCount()-1;if(r>i)throw new Error("Line number ("+r+") greater than maximum line ("+i+")");var a="number"==typeof n&&Number.isFinite(n)&&n>-1,s=o.lineForRow(r),c=s.length,u=a?n:0;if(a){var d=l.getWordRegexp(e,[r,u]).exec(s.substr(n));d&&(c=u+d.index+d[0].length)}else{var f=s.match(/^\s+/);f&&(u=f[0].length)}if(u>s.length)throw new Error("Column start ("+(u||0)+") greater than line length ("+s.length+") for line "+r);return[[r,u],[r,c]]},t.find=h,t.findCached=function(e,t){l.validateFind(e,t);var n=[].concat(t),r=e+":"+n.join(","),o=m.get(r);if(o)try{return s.accessSync(o,s.R_OK),o}catch(e){m.delete(r)}var i=h(e,n);i&&m.set(r,i);return i},t.tempFile=function(e,t,n){if("string"!=typeof e)throw new Error("Invalid or no `fileName` provided");if("string"!=typeof t)throw new Error("Invalid or no `fileContents` provided");if("function"!=typeof n)throw new Error("Invalid or no `callback` provided");return i([{name:e,contents:t}],(function(e){return n(e[0])}))},t.parse=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof e)throw new Error("Invalid or no `data` provided");if("string"!=typeof t)throw new Error("Invalid or no `regex` provided");if("object"!==(void 0===r?"undefined":n(r)))throw new Error("Invalid or no `options` provided");null===p&&(p=Nt);var o={flags:""},i=Object.assign(o,r);-1===i.flags.indexOf("g")&&(i.flags+="g");var a=[],s=new p(t,i.flags),l=s.exec(e);for(;null!==l;){var c=l.groups(),u=c.type,d=c.message,f=c.file||i.filePath||null,m=c.lineStart||c.line||0,h=c.colStart||c.col||0,g=c.lineEnd||c.line||0,v=c.colEnd||c.col||0;a.push({type:u,text:d,filePath:f,range:[[m>0?m-1:0,h>0?h-1:0],[g>0?g-1:0,v>0?v-1:0]]}),l=s.exec(e)}return a};var a=c(f.default),s=c(d.default),l=c(Ct);function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(s)}("next")}))}}var p=null,m=t.FindCache=new Map;function h(e,t){l.validateFind(e,t);for(var n=[].concat(t),r=e.split(a.sep);r.length;){var o=r.join(a.sep);""===o&&(o=a.resolve(e,"/"));var i=!0,c=!1,u=void 0;try{for(var d,f=n[Symbol.iterator]();!(i=(d=f.next()).done);i=!0){var p=d.value,m=a.join(o,p);try{return s.accessSync(m,s.R_OK),m}catch(e){}}}catch(e){c=!0,u=e}finally{try{!i&&f.return&&f.return()}finally{if(c)throw u}}r.pop()}return null}var g=l.wrapExec(nt.exec),v=l.wrapExec(nt.execNode);t.exec=g,t.execNode=v}));const{promisify:Rt}=h.default,It=Rt(m.default.randomBytes),Lt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~".split(""),Mt="0123456789".split(""),Dt="CDEHKMPRTUWXY012458".split(""),Ft="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split(""),Ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),Ut=[void 0,"hex","base64","url-safe","numeric","distinguishable","ascii-printable","alphanumeric"],Wt=(e,t)=>({length:n,type:r,characters:o})=>{if(!(n>=0&&Number.isFinite(n)))throw new TypeError("Expected a `length` to be a non-negative finite number");if(void 0!==r&&void 0!==o)throw new TypeError("Expected either `type` or `characters`");if(void 0!==o&&"string"!=typeof o)throw new TypeError("Expected `characters` to be string");if(!Ut.includes(r))throw new TypeError(`Unknown type: ${r}`);if(void 0===r&&void 0===o&&(r="hex"),"hex"===r||void 0===r&&void 0===o)return t(Math.ceil(.5*n),"hex",n);if("base64"===r)return t(Math.ceil(.75*n),"base64",n);if("url-safe"===r)return e(n,Lt);if("numeric"===r)return e(n,Mt);if("distinguishable"===r)return e(n,Dt);if("ascii-printable"===r)return e(n,Ft);if("alphanumeric"===r)return e(n,Ht);if(0===o.length)throw new TypeError("Expected `characters` string length to be greater than or equal to 1");if(o.length>65536)throw new TypeError("Expected `characters` string length to be less or equal to 65536");return e(n,o.split(""))};var qt=Wt(((e,t)=>{const n=t.length,r=Math.floor(65536/n)*n-1,o=2*Math.ceil(1.1*e);let i="",a=0;for(;a<e;){const s=m.default.randomBytes(o);let l=0;for(;l<o&&a<e;){const e=s.readUInt16LE(l);l+=2,e>r||(i+=t[e%n],a++)}}return i}),((e,t,n)=>m.default.randomBytes(e).toString(t).slice(0,n))),Kt=Wt((async(e,t)=>{const n=t.length,r=Math.floor(65536/n)*n-1,o=2*Math.ceil(1.1*e);let i="",a=0;for(;a<e;){const s=await It(o);let l=0;for(;l<o&&a<e;){const e=s.readUInt16LE(l);l+=2,e>r||(i+=t[e%n],a++)}}return i}),(async(e,t,n)=>(await It(e)).toString(t).slice(0,n)));qt.async=Kt;var zt={angular:"Gillespie59",ava:"avajs",backbone:"ilyavolodin",ember:"netguru","es6-recommended":"https://github.com/mgtitimoli/eslint-plugin-es6-recommended#rules","eslint-comments":"mysticatea","eslint-plugin":"not-an-aardvark",flowtype:"https://github.com/gajus/eslint-plugin-flowtype#RULENAME",fp:"jfmengels",github:"github",immutable:"https://github.com/jhusain/eslint-plugin-immutable#RULENAME",import:"benmosher","import-order":"jfmengels",jasmine:"tlvince",jest:"jest-community",jsdoc:"https://github.com/gajus/eslint-plugin-jsdoc#eslint-plugin-jsdoc-rules-RULENAME","jsx-a11y":"evcohen",lodash:"wix","lodash-fp":"jfmengels",meteor:"dferber90",mocha:"lo1tuma",mongodb:"https://github.com/nfroidure/eslint-plugin-mongodb#RULENAME",mozilla:"https://gecko.readthedocs.io/en/latest/tools/lint/linters/eslint-plugin-mozilla.html#RULENAME","netguru-ember":"https://github.com/netguru/eslint-plugin-netguru-ember/blob/master/docs/RULES.md#RULENAME","no-unsanitized":"mozilla","no-use-extend-native":"dustinspecker",node:"mysticatea",prettier:"https://github.com/prettier/eslint-plugin-prettier#options",promise:"xjamundx",protractor:"alecxe",react:"yannickcr","react-native":"Intellicode","redux-saga":"pke",requirejs:"cvisco",security:"https://github.com/nodesecurity/eslint-plugin-security#rules",standard:"https://github.com/xjamundx/eslint-plugin-standard#rules-explanations",typescript:"nzakas",unicorn:"sindresorhus",xo:"sindresorhus/eslint-plugin-unicorn",visualforce:"forcedotcom",vue:"vuejs","jsx-control-statements":"vkbansal"};for(var Vt of Object.keys(zt)){var Bt=zt[Vt];Bt.includes("/")||(Bt+="/eslint-plugin-"+Vt),2===Bt.split("/").length&&(Bt="https://github.com/"+Bt+"/blob/master/docs/rules/RULENAME.md"),zt[Vt]=Bt}var Jt=function(e){if("string"!=typeof e)throw new TypeError("ruleId must be a string, got "+typeof e);var t=e.split("/");if(1===t.length)return{found:!0,url:"https://eslint.org/docs/rules/"+e};var n=t[0],r=t[1],o=zt[n];return o?{found:!0,url:o.replace("RULENAME",r)}:{found:!1,url:"https://github.com/jfmengels/eslint-rule-documentation/blob/master/contributing.md"}};const Yt=new class{constructor(e){this.replaceRules(e)}replaceRules(e){void 0!==this.rules&&this.rules.clear(),this.rules=new Map(e)}getFixableRules(){const e=[];for(const[t,n]of this.rules)n&&n.meta&&n.meta.fixable&&e.push(t);return e}getRuleUrl(e){const t=this.rules.get(e);return t&&t.meta&&t.meta.docs&&t.meta.docs.url?t.meta.docs.url:Jt(e).url}getRules(){return this.rules}};let Xt=null;function Gt(){null===Xt&&(Xt=new o.Task(require.resolve("./worker.js"))),Xt.started||(Xt.start([]),Xt.started=!0)}function Zt(){null!==Xt&&(Xt.terminate(),Xt=null)}async function Qt(e){return Xt&&!Xt.childProcess.connected&&Zt(),Gt(),e.emitKey=qt({length:10}),new Promise(((t,n)=>{const r=Xt.on(`workerError:${e.emitKey}`,(({msg:e,stack:t})=>{const i=new Error(e);i.stack=t,r.dispose(),o.dispose(),n(i)})),o=Xt.on(e.emitKey,(e=>{r.dispose(),o.dispose(),t(e)}));try{Xt.send(e)}catch(e){r.dispose(),o.dispose(),console.error(e)}}))}async function en(){const e=atom.workspace.getActiveTextEditor();let t,n;atom.workspace.isTextEditor(e)?(t=e.getPath(),n=e.getLastCursor().getScopeDescriptor().getScopesArray()):(t="unknown",n=["unknown"]);const o=atom.packages.resolvePackagePath("linter-eslint");let i;i=void 0===o?{version:"unknown!"}:Q(r.join(o,"package.json"));const a=atom.config.get("linter-eslint"),s=Math.round(process.uptime()/3600*10)/10;let l;try{const e=await Qt({type:"debug",config:a,filePath:t});l={atomVersion:atom.getVersion(),linterEslintVersion:i.version,linterEslintConfig:a,eslintVersion:Q(r.join(e.path,"package.json")).version,hoursSinceRestart:s,platform:process.platform,eslintType:e.type,eslintPath:e.path,editorScopes:n}}catch(e){atom.notifications.addError(`${e}`)}return l}async function tn(){const e=await en();return[`Atom version: ${e.atomVersion}`,`linter-eslint version: ${e.linterEslintVersion}`,`ESLint version: ${e.eslintVersion}`,`Hours since last Atom restart: ${e.hoursSinceRestart}`,`Platform: ${e.platform}`,`Using ${e.eslintType} ESLint from: ${e.eslintPath}`,`Current file's scopes: ${JSON.stringify(e.editorScopes,null,2)}`,`linter-eslint configuration: ${JSON.stringify(e.linterEslintConfig,null,2)}`].join("\n")}function nn(e,t){const{severity:n="error",excerpt:r="",description:o}=t;return[{severity:n,excerpt:r,description:o,location:{file:e.getPath(),position:$t.generateRange(e)}}]}function rn(e,t){const{stack:n,message:r}=t;return nn(e,{severity:"error",excerpt:`Error while running ESLint: ${r.split("\n")[0]}.`,description:`<div style="white-space: pre-wrap">${r}\n<hr />${n}</div>`})}async function on(e,t,n){return Promise.all(e.map((async({fatal:e,message:r,line:i,severity:a,ruleId:s,column:l,fix:c,endLine:u,endColumn:d})=>{const f=e?r.split("\n")[0]:r,p=t.getPath(),m=t.getBuffer();let h,g,v,y=null;if(c){y={position:new o.Range(m.positionForCharacterIndex(c.range[0]),m.positionForCharacterIndex(c.range[1])),replaceWith:c.text}}let w=!1;const b=i-1;"number"==typeof d&&"number"==typeof u?(w=!0,h=Math.max(0,l-1),g=u-1,v=d-1):h="number"==typeof l?l-1:l;let E={severity:1===a?"warning":"error",location:{file:p}};s&&(E.url=Yt.getRuleUrl(s));let _,x=!1;"prettier/prettier"===s&&"Delete `â`"===f&&(x=!0);try{w?(x||(Y(m,b,h),Y(m,g,v)),_=[[b,h],[g,v]]):_=$t.generateRange(t,b,h),E.location.position=_;const e=n?` (${s||"Fatal"})`:"";E.excerpt=`${f}${e}`,y&&(E.solutions=[y])}catch(e){E=await(async({msgLine:e,msgCol:t,msgEndLine:n,msgEndCol:r,eslintFullRange:o,filePath:i,textEditor:a,ruleId:s,message:l})=>{let c=`${e+1}:${t}`;o&&(c+=` - ${n+1}:${r+1}`);const u=`Requested ${o?"start point":"range"}: ${c}`,d=`Invalid position given by '${s}'`;return{severity:"error",excerpt:`${d}. See the description for details. Click the URL to open a new issue!`,url:`https://github.com/AtomLinter/linter-eslint/issues/new?title=${encodeURIComponent(d)}&body=${encodeURIComponent(["ESLint returned a point that did not exist in the document being edited.",`Rule: \`${s}\``,u,"","","\x3c!-- If at all possible, please include code to reproduce this issue! --\x3e","","","Debug information:","```json",JSON.stringify(await en(),null,2),"```"].join("\n"))}`,location:{file:i,position:$t.generateRange(a,0)},description:`${u}\nOriginal message: ${l}`}})({msgLine:b,msgCol:h,msgEndLine:g,msgEndCol:v,eslintFullRange:w,filePath:p,textEditor:t,ruleId:s,message:f})}return E})))}async function an(e,t,n){return Object.prototype.hasOwnProperty.call(e,"updatedRules")&&Yt.replaceRules(e.updatedRules),on(e.messages,t,n)}var sn=Object.freeze({__proto__:null,rules:Yt,startWorker:Gt,killWorker:Zt,sendJob:Qt,getDebugInfo:en,generateDebugString:tn,generateUserMessage:nn,handleError:rn,processESLintMessages:on,processJobResponse:an});const ln=[{added:"January, 2018",description:"Organized config settings into sections",moves:[{old:"disableWhenNoEslintConfig",new:"disabling.disableWhenNoEslintConfig"},{old:"fixOnSave",new:"autofix.fixOnSave"},{old:"ignoreFixableRulesWhileTyping",new:"autofix.ignoreFixableRulesWhileTyping"},{old:"rulesToDisableWhileFixing",new:"autofix.rulesToDisableWhileFixing"},{old:"rulesToSilenceWhileTyping",new:"disabling.rulesToSilenceWhileTyping"},{old:"disableEslintIgnore",new:"advanced.disableEslintIgnore"},{old:"disableFSCache",new:"advanced.disableFSCache"},{old:"showRuleIdInMessage",new:"advanced.showRuleIdInMessage"},{old:"eslintrcPath",new:"global.eslintrcPath"},{old:"advancedLocalNodeModules",new:"advanced.localNodeModules"},{old:"eslintRulesDirs",new:"advanced.eslintRulesDirs"},{old:"useGlobalEslint",new:"global.useGlobalEslint"},{old:"globalNodePath",new:"global.globalNodePath"}]},{added:"September, 2017",description:"Deprecated eslintRulesDir{String} option in favor of eslintRulesDirs{Array<String>}",migrate(e){const t=e.eslintRulesDir;if(t){0===e.eslintRulesDirs.length&&atom.config.set("linter-eslint.eslintRulesDirs",[t]),atom.config.unset("linter-eslint.eslintRulesDir")}}}];var cn=function(e=ln){if(e.length){const t=atom.config.get("linter-eslint");e.forEach((e=>{e.moves&&Array.isArray(e.moves)?e.moves.forEach((e=>{const n=t[e.old];void 0!==n&&(atom.config.set(`linter-eslint.${e.new}`,n),atom.config.unset(`linter-eslint.${e.old}`))})):"function"==typeof e.migrate&&e.migrate(t)}))}};const un=new Set,dn=e=>{let t;t=window.requestIdleCallback((()=>{un.delete(t),e()})),un.add(t)},fn=[];let pn,mn,hn,gn,vn;const yn=e=>Array.from(e).reduce(((e,t)=>Object.assign(e,{[t]:0})),{});module.exports={activate(){this.subscriptions=new o.CompositeDisposable,cn();const e="source.js.embedded.html";this.subscriptions.add(atom.config.observe("linter-eslint.lintHtmlFiles",(t=>{mn=t,mn?fn.push(e):-1!==fn.indexOf(e)&&fn.splice(fn.indexOf(e),1)}))),this.subscriptions.add(atom.config.observe("linter-eslint.scopes",(t=>{fn.splice(0,fn.length),Array.prototype.push.apply(fn,t),mn&&!fn.includes(e)&&fn.push(e)}))),this.subscriptions.add(atom.workspace.observeTextEditors((e=>{e.onDidSave((async()=>{X(e,fn)&&atom.config.get("linter-eslint.autofix.fixOnSave")&&await this.fixJob(!0)}))}))),this.subscriptions.add(atom.commands.add("atom-text-editor",{"linter-eslint:debug":async()=>{const e={detail:await tn(),dismissable:!0};atom.notifications.addInfo("linter-eslint debugging information",e)}})),this.subscriptions.add(atom.commands.add("atom-text-editor",{"linter-eslint:fix-file":async()=>{await this.fixJob()}})),this.subscriptions.add(atom.config.observe("linter-eslint.advanced.showRuleIdInMessage",(e=>{pn=e}))),this.subscriptions.add(atom.config.observe("linter-eslint.disabling.rulesToSilenceWhileTyping",(e=>{hn=e}))),this.subscriptions.add(atom.config.observe("linter-eslint.autofix.rulesToDisableWhileFixing",(e=>{gn=yn(e)}))),this.subscriptions.add(atom.config.observe("linter-eslint.autofix.ignoreFixableRulesWhileTyping",(e=>{vn=e}))),this.subscriptions.add(atom.contextMenu.add({"atom-text-editor:not(.mini), .overlayer":[{label:"ESLint Fix",command:"linter-eslint:fix-file",shouldDisplay:e=>{const t=atom.workspace.getActiveTextEditor();if(!t)return!1;return e.path.some((e=>e.component&&t.component&&e.component===t.component))&&X(t,fn)}}]})),(()=>{const e=()=>{J.install("linter-eslint")},t=()=>{Gt()};atom.inSpecMode()||(dn(e),dn(t))})()},deactivate(){un.forEach((e=>window.cancelIdleCallback(e))),un.clear(),sn&&Zt(),this.subscriptions.dispose()},provideLinter:()=>({name:"ESLint",grammarScopes:fn,scope:"file",lintsOnChange:!0,lint:async e=>{if(!atom.workspace.isTextEditor(e))return null;const t=e.getPath();if(!t)return null;if(t.includes("://"))return nn(e,{severity:"warning",excerpt:"Remote file open, linter-eslint is disabled for this file."});const n=e.getText();let r={};if(e.isModified())if(vn){const e=new Set(Yt.getFixableRules());hn.forEach((t=>e.add(t))),r=yn(e)}else r=yn(hn);try{const o=await Qt({type:"lint",contents:n,config:atom.config.get("linter-eslint"),rules:r,filePath:t,projectPath:atom.project.relativizePath(t)[0]||""});return e.getText()!==n?null:an(o,e,pn)}catch(t){return rn(e,t)}}}),async fixJob(e=!1){const t=atom.workspace.getActiveTextEditor();if(!t||!atom.workspace.isTextEditor(t))return;if(t.isModified()){const e="Linter-ESLint: Please save before fixing";atom.notifications.addError(e)}const n=t.getPath(),r=atom.project.relativizePath(n)[0],o=t.getText();if(0===o.length)return;let i={};Object.keys(gn).length>0&&(i=gn);try{const t=await Qt({type:"fix",config:atom.config.get("linter-eslint"),contents:o,rules:i,filePath:n,projectPath:r});e||atom.notifications.addSuccess(t)}catch(e){atom.notifications.addWarning(e.message)}}};
//# sourceMappingURL=main.js.map
